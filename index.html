<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover">
<title>å’–æ³¢åœ°ç§‘å…¨èª²ç¶±ç‰ˆ ğŸ–</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/naenon/open-huninn-font@1.1/font.css">
<style>
:root {
    --capoo-blue: #71d4f2;
    --capoo-dark: #3a96c4;
    --meat-pink: #f7a8b8;
    --text-brown: #5d4037;
}
* { box-sizing: border-box; font-family: 'openhuninn', sans-serif; }
body { margin: 0; padding: 15px; background-color: #e1f5fe; display: flex; justify-content: center; align-items: center; min-height: 100vh; color: var(--text-brown); }
.card { width: 100%; max-width: 480px; background: #fff; border: 5px solid var(--capoo-blue); border-radius: 40px; padding: 25px; box-shadow: 0px 10px 0px var(--capoo-dark); text-align: center; }
.chapter-btn { width: 100%; background: var(--capoo-blue); border: 3px solid var(--text-brown); padding: 15px; border-radius: 20px; margin-bottom: 12px; color: white; font-size: 17px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 5px 0 var(--capoo-dark); font-weight: bold; }
.progress-inner { height: 100%; background: var(--meat-pink); width: 0%; transition: 0.5s; }
.word-text { font-size: 22px; margin: 20px 0; min-height: 60px; font-weight: bold; color: #333; }
.meaning-text { font-size: 17px; color: white; background: var(--capoo-blue); padding: 12px; border-radius: 20px; border: 3px solid var(--text-brown); margin-bottom: 10px; }
.sentence-box { background: #fff9c4; border: 2px dashed var(--meat-pink); padding: 12px; border-radius: 15px; font-size: 14px; text-align: left; margin-bottom: 15px; }
.btn-choice { width: 100%; background: white; border: 3px solid var(--capoo-blue); padding: 12px; border-radius: 15px; margin-top: 8px; cursor: pointer; font-weight: bold; }
.btn-next { width: 100%; background: var(--meat-pink); color: white; border: 3px solid var(--text-brown); padding: 16px; border-radius: 25px; margin-top: 15px; font-size: 18px; font-weight: bold; box-shadow: 0 5px 0 #d87085; }
.choice-correct { background: #e3f2fd !important; border-color: #2196f3 !important; color: #2196f3; }
.choice-wrong-show-correct { background: #ffebee !important; border-color: #ff5252 !important; color: #ff5252; }
.hidden { display: none; }
</style>
</head>
<body>
<div class="card">
    <div id="home-screen">
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3N2ZndmN3R3eXlyZXA4eGZyeGZyeGZyeGZyeGZyeGZyeGZyeGZyeCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/MeIkaK8fK17C3D5r7t/giphy.gif" style="width:100px;">
        <h2 style="color:var(--capoo-dark)">å’–æ³¢åœ°ç§‘ç²¾è¯ç‰ˆ ğŸ–</h2>
        <div id="chapter-list"></div>
        <button id="final-exam-btn" class="btn-next" style="background:#80cbc4; box-shadow:0 5px 0 #4db6ac;" onclick="startFinalExam()">å¤§æœƒè€ƒ (éš¨æ©Ÿ30é¡Œ)</button>
    </div>

    <div id="study-screen" class="hidden">
        <div style="font-size:14px; font-weight:bold; color:var(--capoo-dark); margin-bottom:5px;">é ç¿’é‡é» (<span id="study-idx">0</span>/20)</div>
        <div style="width:100%; height:10px; background:#eee; border-radius:10px; overflow:hidden;"><div class="progress-inner" id="study-bar"></div></div>
        <div class="word-text" id="study-word"></div>
        <div class="meaning-text" id="study-mean"></div>
        <div class="sentence-box" id="study-note"></div>
        <button class="btn-next" onclick="nextStudy()">ä¸‹ä¸€å€‹é‡é» è‚‰è‚‰!</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <div style="font-size:14px; font-weight:bold; color:var(--capoo-dark); margin-bottom:5px;">æŒ‘æˆ°ä¸­ (å‰©é¤˜ <span id="quiz-remain">0</span> é¡Œ)</div>
        <div style="width:100%; height:10px; background:#eee; border-radius:10px; overflow:hidden;"><div class="progress-inner" id="quiz-bar"></div></div>
        <div class="word-text" id="quiz-q"></div>
        <div id="choices-area"></div>
    </div>

    <div id="finish-screen" class="hidden">
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3N2ZndmN3R3eXlyZXA4eGZyeGZyeGZyeGZyeGZyeGZyeGZyeGZyeCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/Lp97o1821Y9fH38qP7/giphy.gif" style="width:100px;">
        <h2>è‚‰è‚‰å…¥è¢‹ï¼ğŸ–</h2>
        <button class="btn-next" onclick="goHome()">å›ç›®éŒ„</button>
    </div>
</div>

<script>
const courses = [
    {
        title: "7-1 å®‡å®™ (AUèˆ‡å–®ä½å¼·åŒ–)",
        data: [
            {q:"å¤©æ–‡å–®ä½ (AU)", a:"åœ°çƒåˆ°å¤ªé™½çš„å¹³å‡è·é›¢", note:"ç´„ç‚º 1.5 å„„å…¬é‡Œï¼Œé©ç”¨æ–¼å¤ªé™½ç³»å…§è·é›¢ã€‚"},
            {q:"å…‰å¹´ vs AU", a:"1 å…‰å¹´ç´„ç‚º 1 è¬å€‹ AU", note:"å…‰å¹´é©ç”¨æ–¼å¤ªé™½ç³»å¤–çš„æ˜Ÿé«”è·é›¢ã€‚"},
            {q:"æµ·ç‹æ˜Ÿè·é›¢", a:"è·é›¢å¤ªé™½ç´„ 30 AU", note:"å¤ªé™½å…‰å‚³åˆ°æµ·ç‹æ˜Ÿç´„éœ€ 4 å°æ™‚ã€‚"},
            {q:"éŠ€æ²³ç³»ä¿¯è¦–åœ–", a:"å‘ˆç¾æ¼©æ¸¦ç‹€", note:"åŒ…å«å…©åƒå¤šå„„é¡†æ†æ˜Ÿï¼Œå¤ªé™½åªæ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚"},
            {q:"é¡åœ°è¡Œæ˜Ÿå¯†åº¦", a:"å¹³å‡å¯†åº¦è¼ƒé«˜", note:"çµ„æˆæˆåˆ†ä¸»è¦æ˜¯å²©çŸ³èˆ‡é‡‘å±¬ã€‚"},
            {q:"æ°´ä¸‰æ…‹ä¸¦å­˜", a:"ç›®å‰åƒ…åœ¨åœ°çƒç™¼ç¾", note:"é€™èˆ‡åœ°çƒå’Œå¤ªé™½çš„è·é›¢é©ä¸­ã€æœ‰å¤§æ°£å±¤æœ‰é—œã€‚"},
            {q:"å°è¡Œæ˜Ÿå¸¶æˆåˆ†", a:"ä¸»è¦æ˜¯å²©çŸ³èˆ‡é‡‘å±¬çš„ç¢å¡Š", note:"ä½æ–¼ç«æ˜Ÿèˆ‡æœ¨æ˜Ÿè»Œé“ä¹‹é–“ã€‚"},
            {q:"å½—æ˜Ÿè»Œé“", a:"ä»¥å¤ªé™½ç‚ºç„¦é»çš„æ©¢åœ“è»Œé“", note:"è¶Šæ¥è¿‘å¤ªé™½ï¼Œå½—å°¾è¶Šé•·ï¼Œä¸”æŒ‡å‘èƒŒå°å¤ªé™½ã€‚"},
            {q:"éš•çŸ³", a:"æµæ˜Ÿæœªç‡ƒç‡’æ®†ç›¡è€Œæ‰è½åœ°é¢", note:"åœ¨é€²å…¥å¤§æ°£å±¤æ™‚æœƒèˆ‡ç©ºæ°£åŠ‡çƒˆæ‘©æ“¦ã€‚"},
            {q:"å¤§éœ¹é‚ç”¢ç‰©", a:"æ°«(H)èˆ‡æ°¦(He)", note:"å®‡å®™æœ€åˆæœŸå½¢æˆçš„å…©ç¨®ä¸»è¦å…ƒç´ ã€‚"},
            {q:"çŸ®è¡Œæ˜Ÿå®šç¾©", a:"å‘ˆåœ“çƒç‹€ä½†ç„¡æ³•æ¸…é™¤è»Œé“å¤©é«”", note:"ä¾‹å¦‚å†¥ç‹æ˜Ÿã€ç©€ç¥æ˜Ÿã€‚"},
            {q:"æ¯”é„°æ˜Ÿè·é›¢", a:"ç´„ 4.2 å…‰å¹´", note:"å®ƒæ˜¯è·é›¢å¤ªé™½æœ€è¿‘çš„æ†æ˜Ÿã€‚"},
            {q:"éŠ€æ²³ç³»å´è¦–åœ–", a:"ä¸­å¤®å‡¸èµ·çš„åœ“ç›¤ç‹€", note:"å¤–è§€é¡ä¼¼ã€Œè·åŒ…è›‹ã€ã€‚"},
            {q:"æ˜Ÿç³»å®šç¾©", a:"ç”±æ†æ˜Ÿã€æ°£é«”ã€å¡µåŸƒçµ„æˆçš„ç³»çµ±", note:"å¦‚ä»™å¥³åº§æ˜Ÿç³»ã€‚"},
            {q:"å¤ªé™½è³ªé‡ä½”æ¯”", a:"ä½”å¤ªé™½ç³»ç¸½è³ªé‡çš„ 99.8%", note:"å› æ­¤èƒ½ç”¢ç”Ÿå·¨å¤§å¼•åŠ›æŸç¸›æ‰€æœ‰å¤©é«”ã€‚"},
            {q:"é¡æœ¨è¡Œæ˜Ÿç‰¹å¾µ", a:"è³ªé‡å¤§ã€é«”ç©å¤§ã€æœ‰è¡Œæ˜Ÿç’°", note:"æœ¨ã€åœŸã€å¤©ã€æµ·ã€‚"},
            {q:"å¤ªé™½å½¢æˆéç¨‹", a:"æ°£é«”å¡µåŸƒå› è¬æœ‰å¼•åŠ›æ”¶ç¸®", note:"ç´„åœ¨ 46 å„„å¹´å‰ã€‚"},
            {q:"æ†æ˜Ÿç™¼å…‰åŸç†", a:"å…§éƒ¨é€²è¡Œæ ¸èåˆåæ‡‰", note:"ç”±æ°«èåˆæˆæ°¦ï¼Œé‡‹æ”¾å·¨å¤§èƒ½é‡ã€‚"},
            {q:"åŒ—æ¥µæ˜Ÿèˆ‡å¤ªé™½è·é›¢", a:"ç´„ 400 å…‰å¹´", note:"å…‰è¦è·‘ 400 å¹´æ‰æœƒåˆ°åœ°çƒã€‚"},
            {q:"æµæ˜Ÿç™¼å…‰åŸå› ", a:"èˆ‡å¤§æ°£æ‘©æ“¦ç”Ÿç†±", note:"ä¸¦éå¤©é«”è‡ªè¡Œç™¼å…‰ã€‚"}
        ]
    },
    {
        title: "7-2 å››å­£ (ç…§å°„è§’åº¦è£œå¼·)",
        data: [
            {q:"å­£ç¯€æ›´è¿­ä¸»å› ", a:"é™½å…‰ç…§å°„è§’åº¦çš„æ”¹è®Š", note:"ä¸¦éå› ç‚ºåœ°çƒèˆ‡å¤ªé™½çš„è·é›¢é è¿‘ã€‚"},
            {q:"å¤è‡³æ™‚åœ°çƒè·é›¢", a:"åŒ—åŠçƒå¤å­£æ™‚ï¼Œåœ°çƒé›¢å¤ªé™½è¼ƒé ", note:"è­‰æ˜ã€Œè·é›¢è«–ã€æ˜¯éŒ¯çš„ï¼"},
            {q:"åœ°è»¸æŒ‡å‘", a:"æ†æŒ‡å‘åŒ—æ¥µæ˜Ÿæ–¹å‘", note:"èˆ‡å…¬è½‰è»Œé“é¢å¤¾è§’ç´„ 66.5 åº¦ã€‚"},
            {q:"å˜‰ç¾©æ­£åˆå½±é•·", a:"å¤è‡³æœ€çŸ­ã€å†¬è‡³æœ€é•·", note:"å¤è‡³å¤ªé™½ç›´å°„ 23.5Â°Nï¼Œå°±åœ¨å˜‰ç¾©é ­é ‚ã€‚"},
            {q:"æ˜¥ç§‹åˆ†å‡è½", a:"æ­£æ±å‡èµ·ï¼Œæ­£è¥¿è½ä¸‹", note:"å…¨çƒæ™å¤œç­‰é•·ã€‚"},
            {q:"å—åŠçƒå†¬è‡³", a:"ç•¶åŒ—åŠçƒå†¬è‡³æ™‚ï¼Œå—åŠçƒç‚ºå¤è‡³", note:"å—åŒ—åŠçƒå­£ç¯€æ°å¥½ç›¸åã€‚"},
            {q:"æ™å¤œäº¤æ›¿é€±æœŸ", a:"ç´„ 24 å°æ™‚ (ä¸€æ—¥)", note:"åœ°çƒè‡ªè½‰çš„çµæœã€‚"},
            {q:"è‡ªè½‰æ–¹å‘åˆ¤æ–·", a:"åŒ—æ¥µä¸Šç©ºçœ‹æ˜¯é€†æ™‚é˜", note:"èµ¤é“ä¸Šç©ºçœ‹æ˜¯ç”±è¥¿å‘æ±ã€‚"},
            {q:"å˜‰ç¾©å†¬è‡³ä»°è§’", a:"43 åº¦", note:"ä»°è§’æœ€ä½ï¼Œé™½å…‰æœ€æ–œå°„ã€‚"},
            {q:"æ°¸æ™å®šç¾©", a:"å¤ªé™½æ•´å¤©ä¸è½åœ°å¹³ç·š", note:"å¤è‡³æ™‚åŒ—æ¥µåœˆå…§æœƒç™¼ç”Ÿã€‚"},
            {q:"å¤ªé™½è»Œè·¡è¦å¾‹", a:"ç·¯åº¦è¶Šé«˜ï¼Œæ­£åˆå¤ªé™½ä»°è§’è¶Šä½", note:"å½±å­ä¹Ÿæœƒç›¸å°è¼ƒé•·ã€‚"},
            {q:"æ­£åˆæ™‚é–“", a:"å¤ªé™½ä½æ–¼è§€å¯Ÿè€…æ­£å—æ–¹(åŒ—åŠçƒ)", note:"æˆ–æ˜¯é€šéç•¶åœ°å­åˆç·šæ™‚ã€‚"},
            {q:"å½±å­æ–¹å‘", a:"æ°¸é èˆ‡å¤ªé™½æ–¹ä½ç›¸å", note:"æ—©æ™¨å¤ªé™½åœ¨æ±æ–¹ï¼Œå½±å­å°±åœ¨è¥¿æ–¹ã€‚"},
            {q:"æ¥µå…‰è§€æ¸¬", a:"é€šå¸¸ç™¼ç”Ÿåœ¨é«˜ç·¯åº¦åœ°å€", note:"èˆ‡å¤ªé™½å¸¶é›»ç²’å­æœ‰é—œã€‚"},
            {q:"åœ°çƒå…¬è½‰æ–¹å‘", a:"èˆ‡è‡ªè½‰åŒå‘ (é€†æ™‚é˜)", note:"ç¹å¤ªé™½é‹è¡Œä¸€å‘¨ç‚ºä¸€å¹´ã€‚"},
            {q:"ç›´å°„èˆ‡èƒ½é‡", a:"ç›´å°„æ™‚å–®ä½é¢ç©èƒ½é‡æœ€å¼·", note:"é€™å°±æ˜¯å¤å¤©ç‚ç†±çš„åŸå› ã€‚"},
            {q:"ç¯€æ°£èˆ‡æ—¥æœŸ", a:"å¤è‡³ç´„ 6/22ï¼Œå†¬è‡³ç´„ 12/22", note:"æ˜¯åŠƒåˆ†å­£ç¯€çš„é‡è¦æŒ‡æ¨™ã€‚"},
            {q:"åœ°è»¸å‚¾æ–œè§’åº¦", a:"23.5 åº¦", note:"è‹¥åœ°è»¸ä¸å‚¾æ–œï¼Œå°±æ²’æœ‰å››å­£è®ŠåŒ–ã€‚"},
            {q:"åŒ—æ¥µæ˜Ÿé«˜åº¦è§’", a:"ç­‰æ–¼è§€æ¸¬è€…çš„ç·¯åº¦", note:"åœ¨èµ¤é“çœ‹åŒ—æ¥µæ˜Ÿé«˜åº¦ç‚º 0 åº¦ã€‚"},
            {q:"æ™é•·å¤œçŸ­è¦å¾‹", a:"å¤å­£æ™é•·å¤œçŸ­ï¼Œå†¬å­£æ™çŸ­å¤œé•·", note:"æ˜¥ã€ç§‹åˆ†å‰‡å„åŠã€‚"}
        ]
    },
    {
        title: "7-3 æ½®æ± (ç²¾ç¢ºæ™‚é–“è£œå¼·)",
        data: [
            {q:"å…©æ¬¡æ»¿æ½®é–“éš”", a:"ç´„ 12 å°æ™‚ 25 åˆ†", note:"å› ç‚ºæœˆçƒç¹åœ°å…¬è½‰ï¼Œåœ°çƒéœ€å¤šè½‰ä¸€é»ã€‚"},
            {q:"æ½®æ±æ¯æ—¥å»¶é²", a:"å¹³å‡å»¶é² 50 åˆ†é˜", note:"é€™æ˜¯è¨ˆç®—æœªä¾†æ½®æ±æ™‚é–“çš„é—œéµã€‚"},
            {q:"æ½®å·®æœ€å¤§æ™‚åˆ»", a:"å¤§æ½® (æœ”ã€æœ›)", note:"æ—¥ã€æœˆã€åœ°å¼•åŠ›æ’æˆä¸€ç›´ç·šã€‚"},
            {q:"æ½®å·®æœ€å°æ™‚åˆ»", a:"å°æ½® (ä¸Šä¸‹å¼¦æœˆ)", note:"æ—¥ã€æœˆã€åœ°å¤¾è§’å‘ˆ 90 åº¦ã€‚"},
            {q:"æ½®é–“å¸¶å®šç¾©", a:"æ»¿æ½®ç·šèˆ‡ä¹¾æ½®ç·šä¹‹é–“çš„å€åŸŸ", note:"æ˜¯è§€å¯Ÿæµ·æ´‹ç”Ÿæ…‹æœ€è±å¯Œçš„åœ°æ–¹ã€‚"},
            {q:"æœˆäº®å‡èµ·æ™‚é–“", a:"å¹³å‡æ¯å¤©å»¶å¾Œ 50 åˆ†é˜", note:"é€™èˆ‡æ½®æ±å»¶é²çš„åŸå› æ˜¯ä¸€æ¨£çš„ã€‚"},
            {q:"æ»¿æœˆ(æœ›)æœˆç›¸", a:"è¾²æ›†åäº”", note:"æœˆçƒåœ¨èƒŒå°å¤ªé™½çš„é‚£ä¸€å´ã€‚"},
            {q:"ä¸‹å¼¦æœˆäº®å“ªé‚Šï¼Ÿ", a:"äº®å·¦é‚Š (æ±å´)", note:"è¾²æ›†äºŒåäºŒæ—¥å‰å¾Œã€‚"},
            {q:"æ—¥é£Ÿç™¼ç”Ÿæ¢ä»¶", a:"è¾²æ›†åˆä¸€(æœ”)ä¸”ä¸‰è€…æ’æˆç›´ç·š", note:"æœˆäº®æ“‹ä½å¤ªé™½å…‰ã€‚"},
            {q:"æœˆå…¨é£Ÿå‘ˆç´…è‰²", a:"å¤§æ°£æŠ˜å°„ç´…å…‰è‡³æœˆçƒè¡¨é¢", note:"ä¸¦éæœˆçƒè‡ªè¡Œç™¼å…‰ã€‚"},
            {q:"æ½®æ±å¼•åŠ›è²¢ç»", a:"æœˆçƒå½±éŸ¿åŠ›ç´„ç‚ºå¤ªé™½çš„å…©å€", note:"å› ç‚ºæœˆçƒé›¢åœ°çƒéå¸¸è¿‘ã€‚"},
            {q:"ä¹¾æ½®æ™‚æ©Ÿ", a:"æ°´ä½é™åˆ°æœ€ä½é»æ™‚", note:"é©åˆè²¨è¼ªé€²æ¸¯å—ï¼Ÿä¸ï¼Œé©åˆè§€å¯Ÿæ½®é–“å¸¶ã€‚"},
            {q:"è²¨è¼ªé€²æ¸¯æ™‚æ©Ÿ", a:"é€šå¸¸é¸æ“‡ã€Œæ»¿æ½®ã€", note:"å› ç‚ºæ°´æ·±æœ€æ·±ï¼Œé¿å…æ“±æ·ºã€‚"},
            {q:"æœˆäº®æ°¸é åŒä¸€é¢", a:"è‡ªè½‰èˆ‡å…¬è½‰é€±æœŸç›¸åŒ", note:"çš†ç´„ç‚º 27.3 å¤©ã€‚"},
            {q:"æœ”ã€æœ›ã€å¼¦æœˆ", a:"ä»£è¡¨æœˆäº®çš„ä¸åŒä½ç½®", note:"åæ˜ äº†æ—¥åœ°æœˆç›¸å°è§’åº¦ã€‚"},
            {q:"ä¸Šå¼¦æœˆä½•æ™‚å‡èµ·ï¼Ÿ", a:"ä¸­åˆå·¦å³å‡èµ·", note:"é»ƒæ˜æ™‚å‡ºç¾åœ¨æ­£å—æ–¹ã€‚"},
            {q:"æ—¥åé£Ÿ", a:"æœˆçƒé®ä½å¤ªé™½çš„ä¸€éƒ¨åˆ†", note:"è§€æ¸¬æ™‚éœ€æˆ´å¤ªé™½è§€æ¸¬çœ¼é¡ã€‚"},
            {q:"æœˆç›¸ç›ˆè™§é€±æœŸ", a:"ç´„ 29.5 å¤©", note:"æ¯”å…¬è½‰é€±æœŸé•·ï¼Œå› åœ°çƒä¹Ÿåœ¨ç¹æ—¥ã€‚"},
            {q:"æ½®å·®è¨ˆç®—", a:"æ»¿æ½®æ°´ä½æ¸›ä¹¾æ½®æ°´ä½", note:"é€™åæ˜ äº†å¼•åŠ›çš„å¼·åº¦ã€‚"},
            {q:"é‡£é­šå¥½æ™‚æ©Ÿ", a:"æ¼²æ½®æ™‚", note:"é­šç¾¤é€šå¸¸æœƒéš¨æ¼²æ½®é è¿‘å²¸é‚Šè¦“é£Ÿã€‚"}
        ]
    }
];

// é‚è¼¯éƒ¨åˆ†ä¿æŒä¸è®Š...
let currentIdx = 0; let qQueue = []; let finished = JSON.parse(localStorage.getItem('capoo_v5')) || []; let sess = { ans: false, total: 0, idx: 0 };
function init() { renderHome(); }
function renderHome() {
    const list = document.getElementById('chapter-list'); list.innerHTML = "";
    courses.forEach((c, i) => { const ok = finished.includes(i); list.innerHTML += `<button class="chapter-btn" onclick="sel(${i})"><span>${c.title}</span><span class="chapter-status">${ok?'âœ…':'å¾…è‚‰'}</span></button>`; });
    if(finished.length === courses.length) document.getElementById('final-exam-btn').style.background="#f7a8b8";
}
function sel(i) { currentIdx=i; sess.idx=0; document.getElementById('home-screen').classList.add('hidden'); document.getElementById('study-screen').classList.remove('hidden'); showS(); }
function showS() { let d=courses[currentIdx].data[sess.idx]; document.getElementById('study-word').innerText=d.q; document.getElementById('study-mean').innerText=d.a; document.getElementById('study-note').innerText=d.note; document.getElementById('study-idx').innerText=sess.idx+1; document.getElementById('study-bar').style.width=((sess.idx+1)/20*100)+"%"; }
function nextStudy() { if(sess.idx<19) { sess.idx++; showS(); } else { startQ(courses[currentIdx].data); } }
function startQ(list) { qQueue=[...list].sort(()=>Math.random()-0.5); sess.total=qQueue.length; document.getElementById('study-screen').classList.add('hidden'); document.getElementById('quiz-screen').classList.remove('hidden'); renderQ(); }
function renderQ() {
    sess.ans=false; if(qQueue.length===0) return fin();
    let itm=qQueue[0]; document.getElementById('quiz-remain').innerText=qQueue.length; document.getElementById('quiz-bar').style.width=((sess.total-qQueue.length)/sess.total*100)+"%"; document.getElementById('quiz-q').innerText=itm.q;
    let area=document.getElementById('choices-area'); area.innerHTML="";
    let pool=currentIdx===-1?courses.flatMap(c=>c.data):courses[currentIdx].data;
    let picks=pool.filter(x=>x.q!==itm.q).sort(()=>Math.random()-0.5).slice(0,3);
    [...picks, itm].sort(()=>Math.random()-0.5).forEach(o=>{
        let b=document.createElement('button'); b.className="btn-choice"; b.innerText=o.a;
        b.onclick=()=>{
            if(sess.ans) return; sess.ans=true;
            if(o.q===itm.q){ b.classList.add('choice-correct'); qQueue.shift(); }
            else { Array.from(area.children).forEach(btn=>{if(btn.innerText===itm.a) btn.classList.add('choice-wrong-show-correct');}); qQueue.push(qQueue.shift()); }
            setTimeout(renderQ, 1200);
        }; area.appendChild(b);
    });
}
function fin() { if(currentIdx>=0 && !finished.includes(currentIdx)) { finished.push(currentIdx); localStorage.setItem('capoo_v5', JSON.stringify(finished)); } document.getElementById('quiz-screen').classList.add('hidden'); document.getElementById('finish-screen').classList.remove('hidden'); }
function goHome() { document.getElementById('finish-screen').classList.add('hidden'); document.getElementById('home-screen').classList.remove('hidden'); renderHome(); }
function startFinalExam() {
    if(finished.length<courses.length) return alert("è¦å…ˆåƒå®Œå‰ä¸‰ç« çš„è‚‰è‚‰å–”ï¼");
    currentIdx=-1; document.getElementById('home-screen').classList.add('hidden'); document.getElementById('quiz-screen').classList.remove('hidden');
    qQueue=courses.flatMap(c=>c.data).sort(()=>Math.random()-0.5).slice(0,30); sess.total=30; renderQ();
}
function resetProgress() { if(confirm("ç¢ºå®šé‡ç½®å—ï¼Ÿ")) { localStorage.clear(); finished=[]; renderHome(); } }
init();
</script>
</body>
</html>